---
id: TC-LOGIN-002
title: Негативний логін — 3 послідовні невдалі спроби → короткий cooldown (60 с)
module: Login
type: negative
priority: High
severity: Major
environment: Windows 10, Chrome 126, 1920x1080
assumptions:
  failed_attempts_before_cooldown: 3
  cooldown_seconds: 60
---

## Передумови
- Є активний підтверджений користувач з email `test.user@example.com`.
- Відомий **правильний пароль** `StrongPass123!` (потрібен для перевірки поведінки під час cooldown).
- Тест виконується у приватному вікні або після очищення кешу/куків.

## Тестові дані
- Невірні паролі: `Wrong#1`, `Wrong#2`, `Wrong#3`.

## Кроки
1. Відкрити `/login`.
2. **Спроба 1:** ввести email `test.user@example.com`, пароль `Wrong#1` → натиснути **Sign in**.
3. **Спроба 2:** ввести пароль `Wrong#2` → **Sign in**.
4. **Спроба 3:** ввести пароль `Wrong#3` → **Sign in**.
5. **Одразу після 3-ї спроби** (не чекаючи 60 с) ввести **правильний пароль** `StrongPass123!` → **Sign in**.

## Очікуваний результат
- Після спроб 1–2:
  - Показується повідомлення **«Неправильний email або пароль»**.
  - Сторінка залишається `/login`, сесію **не** створено.
- Після спроби 3:
  - Відображається повідомлення **«Забагато невдалих спроб. Спробуйте ще раз через 60 секунд»**.
  - Наступні спроби логіну блокуються.
  - Немає редиректу, токен/сесійний cookie **не** встановлюється.
- Крок 5: навіть з правильним паролем логін відхилений тим самим повідомленням про cooldown.

## Критерії Pass/Fail
- **Pass:** після 3-ї спроби вмикається cooldown (60 с); під час нього навіть з правильним паролем логін не проходить.
- **Fail:** cooldown не працює; під час нього користувач може увійти; або створюється сесія.

## Післяумови
- Дочекатися завершення cooldown перед іншими тестами.

